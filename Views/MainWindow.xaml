<Window
    x:Class="Starter.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:Starter.Controls"
    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
    xmlns:vm="clr-namespace:Starter.ViewModels"
    Title="Starter"
    Background="Transparent"
    PreviewKeyDown="Window_PreviewKeyDown"
    PreviewMouseWheel="MainWindow_PreviewMouseWheel"
    ResizeMode="CanResize"
    ShowInTaskbar="True"
    WindowStyle="None">

    <Window.DataContext>
        <vm:MainWindowViewModel />
    </Window.DataContext>

    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome
            CaptionHeight="0"
            GlassFrameThickness="0"
            ResizeBorderThickness="8" />
    </shell:WindowChrome.WindowChrome>

    <Grid x:Name="RootGrid">


        <Border
            x:Name="ResizeShell"
            Background="#01FFFFFF"
            Cursor="SizeNWSE" />

        <!--  几乎透明但不是完全透明  -->
        <!--<Border
            Width="30"
            Height="30"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            Background="#01FFFFFF"
            Cursor="SizeNWSE"
            Opacity="1.001" />-->

        <!--  只在非模糊模式使用  -->
        <Border
            x:Name="RootBorder"
            Background="Transparent"
            ClipToBounds="True"
            SnapsToDevicePixels="True"
            UseLayoutRounding="True">

            <Grid x:Name="BackgroundGrid" />

        </Border>


        <Border>
            <Grid x:Name="Content">
                <!--  内容层  -->
                <Grid.RowDefinitions>
                    <RowDefinition Height="36" />
                    <RowDefinition Height="46" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>



                <Grid Margin="0">
                    <!--  顶部标题栏  -->
                    <Border
                        Height="36"
                        VerticalAlignment="Top"
                        Background="#00000000"
                        Cursor="Hand"
                        MouseLeftButtonDown="Window_MouseLeftButtonDown">

                        <Grid Margin="10,0">
                            <!--  左侧：图标和名称  -->
                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                <Image
                                    Width="20"
                                    Height="20"
                                    Margin="0,0,10,0"
                                    Source="pack://application:,,,/Resources/app.png" />
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Foreground="White"
                                    Text="QuickLaunch" />
                            </StackPanel>

                            <!--  右侧：锁定和关闭按钮  -->
                            <StackPanel
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                                <Button
                                    Width="30"
                                    Height="30"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Command="{Binding LockCommand}"
                                    Cursor="Hand"
                                    ToolTip="锁定/解锁">
                                    <Image Width="16" Height="16">
                                        <Image.Style>
                                            <Style TargetType="Image">
                                                <Setter Property="Source" Value="pack://application:,,,/Resources/lock_open.png" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsLocked, Mode=TwoWay}" Value="True">
                                                        <Setter Property="Source" Value="pack://application:,,,/Resources/lock.png" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Image.Style>
                                    </Image>
                                </Button>


                                <Button
                                    Width="30"
                                    Height="30"
                                    Margin="5,0,0,0"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Command="{Binding SetCommand}"
                                    Cursor="Hand"
                                    ToolTip="设置">
                                    <Image
                                        Width="18"
                                        Height="18"
                                        Source="pack://application:,,,/Resources/set.png" />
                                </Button>

                                <Button
                                    Width="30"
                                    Height="30"
                                    Margin="5,0,0,0"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Command="{Binding CloseCommand}"
                                    Cursor="Hand"
                                    ToolTip="关闭">
                                    <Image
                                        Width="16"
                                        Height="16"
                                        Source="pack://application:,,,/Resources/close.png" />
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>

                </Grid>

                <controls:TabBarView
                    Grid.Row="1"
                    Margin="0,0,0,0"
                    DataContext="{Binding TabBar}" />

                <controls:GridBoardControl
                    x:Name="GridBoard"
                    Grid.Row="2"
                    CellSize="80"
                    ItemsSource="{Binding TestItems}" />
            </Grid>

        </Border>

        <Button
            x:Name="FitGridButton"
            Width="28"
            Height="28"
            Margin="8"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            Background="#22000000"
            BorderThickness="0"
            Click="FitGridButton_Click"
            Cursor="Hand">
            <TextBlock
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                FontSize="14"
                Foreground="White"
                Text="▢" />
        </Button>

    </Grid>
</Window>
